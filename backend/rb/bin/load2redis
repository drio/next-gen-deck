#!/usr/bin/env ruby
#
# This tool will traverse the current directory looking for
# csv files. When found, it would update redis with the contents.
#
# All deps (except redis) come with ruby
#
%w{find pp redis json ostruct}.each {|l| require l}
$: << File.join(File.dirname(File.dirname($0)), "lib")
%w{toredis loading}.each {|l| require l}

# MAIN
#
$stderr.puts ">> Loading csvs ..."
csvs = Loading.all_csvs
$stderr.puts ">> Data for #{csvs.size} bam(s) loaded."
$stderr.puts ">> Dumping into redis ..."
ToRedis.dump csvs
